---
# includes/set-awxteams.yml

      - name: Check if team exists
        command: 'awx teams list all --name "{{ item.name }}" --conf.host {{ awx_hostname }} --conf.token {{ awxtoken_active }} -f json'
        register: awx_data

      - name: Set teams data to json format
        set_fact:
          data_json: "{{ awx_data.stdout | from_json }}"
        when: awx_data.rc == 0

      - name: Create organization teams on awx server
        command: 'awx team create --name "{{ item.name }}" --description "{{ item.desc }}" --organization "{{ organization_id }}" --conf.host {{ awx_hostname }} --conf.token {{ awxtoken_active }} -f json'
        when: data_json is defined and data_json.count == 0
